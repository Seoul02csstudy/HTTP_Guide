# 다이제스트 인증

* 널리 쓰이지는 않지만, 그 개념은 보안 트랜잭션을 구현하고자 하는 이들에게 유용하다

* 전송 계층 보안 > 다이제스트 인증 > 기본 인증

* 다이제스트 인증의 특징
  
  <img src="다이제스트%20인증_assets/f714231f4b1944f838ff8d890efe0c6c6f8d28ef.png" title="" alt="화면 캡처 2022-12-20 115722.png" width="469">
  
  * 단방향 요약 함수 MD5 사용
    
    * 단방향 : 양방향과 달리 암호화 된 것을 복구(복호화) 불가능 한 것
    
    * 원래 길이와 상관없이 128비트 요약으로 변환
      
      <img src="다이제스트%20인증_assets/87753aa8221e9c8e80a1c13926ed589d2d1a6080.png" title="" alt="화면 캡처 2022-12-20 133742.png" width="567">
  
  * 재전송 방지를 위한 난스 사용
    
    * WWW-Authenticate에 자주 바뀌는 난스를 담아, 클라이언트가 비밀번호에 난스 붙여, 요약을 계속 변경되게 함
  
  * 기본 인증과 다이제스트 인증 핸드셰이크 비교
    
    ![화면 캡처 2022-12-20 141330.png](다이제스트%20인증_assets/19d8204c62097bda26e70e7c9b349a5f287efb64.png)

* 요약 계산
  
  * 요약 알고리즘 입력 데이터
    
    * H(d) : 단방향 해시 함수
    
    * KD(s,d) : 요약 함수
    
    * s : 비밀
    
    * d : 데이터
    
    * A1 : 보안 정보 담은 데이터 덩어리
    
    * A2 : 비밀이 아닌 것 담은 데이터 덩어리
  
  * H(d) 와 KD(s,d) 알고리즘
    
    * RFC-2617에는 MD5(기본값), MD5-sess 있음
    
    * H(d) 는 데이터의 MD5를 계산
    
    * KD(s,d) 는  콜론으로 연결된 비밀 데이터, 일반 데이터의 MD5를 계산
  
  * A1 (메세지 X)
    
    * 사용자 이름, 비밀번호, 보호 영역, 난스와 같은 비밀 보호 정보
    
    * RFC 2617은 A1 를 MD5, MD5-sess로 계산 할 수 있음
      
      ![화면 캡처 2022-12-20 143051.png](다이제스트%20인증_assets/19473129b0c7a5dc983d6a58a583d1629d66e0b8.png)
  
  * A2 (메세지 관련 데이터)
    
    * url, 요청 메서드, 메시지 본문 등 메세지 자체의 정보로, 이것들의 위조를 방지하기 위해 사용됨
    
    * qop(quality of protection) 에 따른 A2의 두 가지 사용법
      
      * HTTP 요청 메서드, URL만 포함하는 것, qop="auth"(기본값)
      
      * 메시지 본문을 추가, qop="auth-int"
        
        ![화면 캡처 2022-12-20 143735.png](다이제스트%20인증_assets/34953413acf243feb1798ce6f48fbb1c4e8f7e9d.png)
  
  * 요약 알고리즘 전반
    
    * qop 유무에 따라 H,KD,A1,A2 요약 계산에는 2가지 방법 존재
      
      ![화면 캡처 2022-12-20 144525.png](다이제스트%20인증_assets/753e937bb9616800c48ab628b81a6ebbb66f14c7.png)
  
  * 사전(preemptive) 인가
    
    ![화면 캡처 2022-12-20 150956.png](다이제스트%20인증_assets/26a2086443cf50ed66f3e21e3d3e68bf57010ef4.png)


